<!DOCTYPE html>
<html>
  <head>
    <title>Deleting ranges of Docker images using filters ~ Tiemen</title><meta name="viewport" content="width=device-width, initial-scale=1.0" /> <link
rel="stylesheet" href="/css/main.css" />
<link rel="icon" type="image/png" sizes="16x16" href="/favicon.svg" />


<script
  async
  src="https://www.googletagmanager.com/gtag/js?id=UA-25416548-1"
></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag() {
    dataLayer.push(arguments);
  }
  gtag("js", new Date());

  gtag("config", "UA-25416548-1");
</script>
<meta property="og:title" content="Deleting ranges of Docker images using filters ~ Tiemen" />
    <meta name="twitter:title" content="Deleting ranges of Docker images using filters ~ Tiemen" />
    <meta itemprop="name" content="Deleting ranges of Docker images using filters ~ Tiemen" />
    <meta name="application-name" content="Deleting ranges of Docker images using filters ~ Tiemen" />
    <meta property="og:site_name" content="" />

    <meta name="keywords" content="" />

    <meta name="description" content="After working with Docker for a while, the output of `docker images` most likely spans many, many lines. Here&#39;s how to make it clean and tidy again" />
    <meta itemprop="description" content="After working with Docker for a while, the output of `docker images` most likely spans many, many lines. Here&#39;s how to make it clean and tidy again" />
    <meta property="og:description" content="After working with Docker for a while, the output of `docker images` most likely spans many, many lines. Here&#39;s how to make it clean and tidy again" />
    <meta name="twitter:description" content="After working with Docker for a while, the output of `docker images` most likely spans many, many lines. Here&#39;s how to make it clean and tidy again" />

    <link rel="canonical" href="https://tiemenwaterreus.com/posts/deleting-ranges-of-docker-images/" itemprop="url" />
    <meta name="url" content="https://tiemenwaterreus.com/posts/deleting-ranges-of-docker-images/" />
    <meta name="twitter:url" content="https://tiemenwaterreus.com/posts/deleting-ranges-of-docker-images/" />
    <meta property="og:url" content="https://tiemenwaterreus.com/posts/deleting-ranges-of-docker-images/" />
  </head>
  <body>
    <section class="single-post">
      <section class="post-pre-header">
        <a href="/posts" class="bring-me-back">&larr; all posts</a>

        <div class="meta">
          Posted on Sep 10, 2019
        </div>
      </section>

      <h1>Deleting ranges of Docker images using filters</h1>
      <p>If the output of <code>docker images</code> spans too many lines and you want to tidy it up, but you think <a href="https://docs.docker.com/engine/reference/commandline/system_prune/"><code>docker system prune</code></a> is like using C4 to open a can of tuna, maybe take <code>docker images</code>&rsquo;s <code>-f</code> flag for a spin!</p>
<p><code>docker images -f</code> utilises the <a href="https://docs.docker.com/engine/reference/commandline/images/#filtering">filter option</a> and it lets you specify some extra search options to select exactly the images you&rsquo;re interested in!</p>
<h1 id="filter-options">Filter Options</h1>
<p>Currently Docker supports a list of filter options, but in this write-up we&rsquo;re only focussing on the <code>before</code> and <code>since</code> filters - go for a full overview of the available filter options to the <a href="https://docs.docker.com/engine/reference/commandline/images/#filtering">Docker Docs on Filtering</a></p>
<p><strong>-f since={image id}</strong>
The filter option since takes an image ID and selects all the images that are newer than the given image.</p>
<p><strong>-f before={image id}</strong>
Much like since, this tag selects all the images that are older than the given image id.</p>
<p>And to select a whole range of Docker Images, simply stick &lsquo;em together!</p>
<h1 id="example">Example</h1>
<p>Enough talking; show me the money! So - imagine the output of <code>docker images</code> looks like the following:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span>hippo-fe            latest              ec8ec381807d        <span style="color:#3677a9">55</span> minutes ago      455MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>hippo-backend_api   latest              88a08f954c9f        <span style="color:#3677a9">4</span> days ago          47.4MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>&lt;none&gt;              &lt;none&gt;              66ee4e399b4a        <span style="color:#3677a9">4</span> days ago          423MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>&lt;none&gt;              &lt;none&gt;              098006369e17        <span style="color:#3677a9">4</span> days ago          449MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>&lt;none&gt;              &lt;none&gt;              7010975558a2        <span style="color:#3677a9">4</span> days ago          449MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span>&lt;none&gt;              &lt;none&gt;              75ecd4cee8ef        <span style="color:#3677a9">4</span> days ago          47.4MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>&lt;none&gt;              &lt;none&gt;              d3942b2482a2        <span style="color:#3677a9">4</span> days ago          449MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span>&lt;none&gt;              &lt;none&gt;              88676747d621        <span style="color:#3677a9">4</span> days ago          449MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>&lt;none&gt;              &lt;none&gt;              eb522755627b        <span style="color:#3677a9">4</span> days ago          445MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span>&lt;none&gt;              &lt;none&gt;              d62380cf625f        <span style="color:#3677a9">5</span> days ago          86.3MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span>&lt;none&gt;              &lt;none&gt;              21bce955c85b        <span style="color:#3677a9">5</span> days ago          474MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span>spacevim/spacevim   latest              a6b4bb27c4e9        <span style="color:#3677a9">2</span> weeks ago         1.36GB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span>&lt;none&gt;              &lt;none&gt;              abf507ccc201        <span style="color:#3677a9">2</span> weeks ago         106MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span>&lt;none&gt;              &lt;none&gt;              79a409b99ca5        <span style="color:#3677a9">2</span> weeks ago         530MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">16</span>&lt;none&gt;              &lt;none&gt;              5fd5b5859b37        <span style="color:#3677a9">3</span> weeks ago         106MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">17</span>&lt;none&gt;              &lt;none&gt;              d93260d7abc3        <span style="color:#3677a9">3</span> weeks ago         530MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">18</span>node                10.16.3-alpine      b95baba1cfdb        <span style="color:#3677a9">3</span> weeks ago         76.4MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">19</span>&lt;none&gt;              &lt;none&gt;              2c62a47471d1        <span style="color:#3677a9">4</span> weeks ago         106MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">20</span>&lt;none&gt;              &lt;none&gt;              3de57027cc18        <span style="color:#3677a9">4</span> weeks ago         523MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">21</span>elixir              1.9.1-alpine        33a0cf122cf7        <span style="color:#3677a9">5</span> weeks ago         87.6MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">22</span>&lt;none&gt;              &lt;none&gt;              e5196ef97445        <span style="color:#3677a9">6</span> weeks ago         104MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">23</span>elixir              1.8.1-alpine        447a8dff23a8        <span style="color:#3677a9">5</span> months ago        91.1MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">24</span>alpine              3.9                 5cb3aa00f899        <span style="color:#3677a9">6</span> months ago        5.53MB
</code></pre></div><p>That&rsquo;s quite the list! Let&rsquo;s say we&rsquo;re no longer interested in the images below the image tagged as <code>hippo-backend_api</code> with image id <code>88a08f954c9f</code> and the images above <code>spacevim/spacevim</code> with image id <code>a6b4bb27c4e9</code>, how would we go about that using the filters described above?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>$ docker images -f <span style="color:#40ffff">before</span>=88a08f954c9f
</code></pre></div><p>Would give us all the images that are created <em>before</em> the <em>hippo-backend_api</em> one. Next step would be to select all the Docker images up-to a given image in history:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>$ docker images -f <span style="color:#40ffff">before</span>=88a08f954c9f -f <span style="color:#40ffff">since</span>=a6b4bb27c4e9
</code></pre></div><p>Gives us all the images in a given range:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>&lt;none&gt;              &lt;none&gt;              66ee4e399b4a        <span style="color:#3677a9">4</span> days ago          423MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span>&lt;none&gt;              &lt;none&gt;              098006369e17        <span style="color:#3677a9">4</span> days ago          449MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">3</span>&lt;none&gt;              &lt;none&gt;              7010975558a2        <span style="color:#3677a9">4</span> days ago          449MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">4</span>&lt;none&gt;              &lt;none&gt;              75ecd4cee8ef        <span style="color:#3677a9">4</span> days ago          47.4MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">5</span>&lt;none&gt;              &lt;none&gt;              d3942b2482a2        <span style="color:#3677a9">4</span> days ago          449MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">6</span>&lt;none&gt;              &lt;none&gt;              88676747d621        <span style="color:#3677a9">4</span> days ago          449MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">7</span>&lt;none&gt;              &lt;none&gt;              eb522755627b        <span style="color:#3677a9">4</span> days ago          445MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">8</span>&lt;none&gt;              &lt;none&gt;              d62380cf625f        <span style="color:#3677a9">5</span> days ago          86.3MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">9</span>&lt;none&gt;              &lt;none&gt;              21bce955c85b        <span style="color:#3677a9">5</span> days ago          474MB
</code></pre></div><p>As you can see we&rsquo;re now only given the images in the selected range!</p>
<p>Soo - all we have to do now is tag on the <code>-q</code> flag to solely get a list of image ID&rsquo;s and pipe it into <code>xargs</code> to use them as arguments in the <code>docker rmi -f</code> command&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">1</span>$ docker images -f <span style="color:#40ffff">before</span>=a6b4bb27c4e9 -f <span style="color:#40ffff">since</span>=88a08f954c9f -q | xargs docker rmi -f
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">2</span>
</code></pre></div><p>&hellip; and voila! If we then run the docker images command again, we&rsquo;ll see that the given range has been deleted:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 1</span>REPOSITORY          TAG                 IMAGE ID            CREATED             SIZE
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 2</span>hippo-fe            latest              ec8ec381807d        <span style="color:#3677a9">2</span> hours ago         455MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 3</span>hippo-backend_api   latest              88a08f954c9f        <span style="color:#3677a9">4</span> days ago          47.4MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 4</span>spacevim/spacevim   latest              a6b4bb27c4e9        <span style="color:#3677a9">2</span> weeks ago         1.36GB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 5</span>&lt;none&gt;              &lt;none&gt;              abf507ccc201        <span style="color:#3677a9">2</span> weeks ago         106MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 6</span>&lt;none&gt;              &lt;none&gt;              79a409b99ca5        <span style="color:#3677a9">2</span> weeks ago         530MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 7</span>&lt;none&gt;              &lt;none&gt;              5fd5b5859b37        <span style="color:#3677a9">3</span> weeks ago         106MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 8</span>&lt;none&gt;              &lt;none&gt;              d93260d7abc3        <span style="color:#3677a9">3</span> weeks ago         530MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868"> 9</span>node                10.16.3-alpine      b95baba1cfdb        <span style="color:#3677a9">3</span> weeks ago         76.4MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">10</span>&lt;none&gt;              &lt;none&gt;              2c62a47471d1        <span style="color:#3677a9">4</span> weeks ago         106MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">11</span>&lt;none&gt;              &lt;none&gt;              3de57027cc18        <span style="color:#3677a9">4</span> weeks ago         523MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">12</span>elixir              1.9.1-alpine        33a0cf122cf7        <span style="color:#3677a9">5</span> weeks ago         87.6MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">13</span>&lt;none&gt;              &lt;none&gt;              e5196ef97445        <span style="color:#3677a9">6</span> weeks ago         104MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">14</span>elixir              1.8.1-alpine        447a8dff23a8        <span style="color:#3677a9">5</span> months ago        91.1MB
<span style="margin-right:0.4em;padding:0 0.4em 0 0.4em;color:#686868">15</span>alpine              3.9                 5cb3aa00f899        <span style="color:#3677a9">6</span> months ago        5.53MB
</code></pre></div><p>🙌</p>

    </section>
  </body>
</html>
