<!DOCTYPE html>
<html lang="en-EN">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta content="keyword 1, keyword 2, keyword 3" name="keywords">
<meta content="CryptoPatrick" name="author">
<meta property="og:title" content="üî† Grammatical Framework 3.12 - Seamless Global Nature">
<meta property="og:url" content="https://www.cryptopatrick.com/blog/2025/09/02/grammatical-framework-3.12/">
<meta property="og:description" content="">
<meta property="og:type" content="website" />


<meta property="og:image" content="https://www.cryptopatrick.com/img/post-name/name.jpg" />


<title>üî† Grammatical Framework 3.12 | Seamless Global Nature</title>

<link rel="stylesheet" href="https://www.cryptopatrick.com//css/style.css">
<link rel="stylesheet" href="https://www.cryptopatrick.com//css/customcode.css">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<link rel="stylesheet"
      href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.0/build/styles/default.min.css">

</head>

<body>
<section class="section">
  <div class="container">
    <nav class="nav">

 <img src="../../../../../profile.jpg" alt="Avatar" style="margin-right: 1em" height="100px">
      <div class="nav-left" style="flex-basis: auto;">
        <a class="nav-item" href="https://www.cryptopatrick.com/"><h1 class="title is-4">Seamless Global Nature</h1></a>
      <nav class="nav-item level is-mobile">
          
          
          <a class="level-item" href="https://www.cryptopatrick.com/about/" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-male"></i>
            </span>
            
            About Me
          </a>
          
          <a class="level-item" href="https://www.cryptopatrick.com/tags/" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-tags"></i>
            </span>
            
            Tags
          </a>
          
          <a class="level-item" href="https://100-days-of-vibe.vercel.app" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-paper-plane"></i>
            </span>
            
            100DaysOfVibe
          </a>
          
          <a class="level-item" href="https://x.com/cryptopatrick" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-twitter"></i>
            </span>
            
             
          </a>
          
          <a class="level-item" href="https://github.com/cryptopatrick?tab=repositories" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-github"></i>
            </span>
            
             
          </a>
          
          <a class="level-item" href="https://www.instagram.com/cryptopatrickk/" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-instagram"></i>
            </span>
            
             
          </a>
          
        </nav>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile">
          
        </nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <h1 class="title">üî† Grammatical Framework 3.12</h1>
    
    
    <h2 class="subtitle is-5">
      September 2, 2025
       by CryptoPatrick
      
        
        <span class="tags-inline" style="margin-left:0.1em;">
          
            
            <a class="tag is-link is-light" href="../../../../../tags/linguistics/" style="margin-left:0.25em;">Linguistics</a>
          
            
            <a class="tag is-link is-light" href="../../../../../tags/rust/" style="margin-left:0.25em;">Rust</a>
          
        </span>
      
      
    </h2>
    <div class="content">
      <!-- ////////////////////////////////////////////////////////////////////////-->
<p><img src="https://img.shields.io/badge/Work_In_Progress-orange.svg" alt="Version:0.1.0">
<img src="https://img.shields.io/badge/Text_Version-0.4.5-blue.svg" alt="Version:0.1.0">
<img src="https://img.shields.io/badge/Source_Code_Builds-Yes-green.svg" alt="Version:0.1.0"></p>
<!-- ////////////////////////////////////////////////////////////////////////-->
<br>
<blockquote>
<p><strong>Preface:</strong> The reason for this post on GF is that GF version 3.12 was released on 8 August 2025,
with the previous version, 3.11, released three years ago, back in 2021-07-25.
What&rsquo;s more, GF 3.12 provides support for Apple Silicon Mac computers (M1, M2, M3, M4).</p>
</blockquote>
<!-- ////////////////////////////////////////////////////////////////////////-->
<h2 id="what-is-grammatical-framework-gf">What is Grammatical Framework (GF)</h2>
<p>GF (<strong>Ranta, 2011</strong>) is both a <em>formal grammar language</em> and a <em>development platform</em>.<br>
With GF we can solve a wide range of language specific needs, such as <em>natural language processing</em>, <em>translation</em>, and create <em>grammar-based software</em> tools. GF provides a <em>CLI</em> and a <em>programming language</em>, which we can
use to build <em>multilingual grammars</em><br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†ÄPerhaps the biggest exclamation point is, that GF is <strong>Rule Based</strong> while LLMs like
ChatGPT are <strong>Stat Based</strong>. An LLM needs to be trained on a lot of data, while with
GF you can litteraly just write a grammar, compile it, and it&rsquo;ll work.
The trade-off is flexibility, with an LLM you can handle a very wide range of sentences,
while a rule based system like GF can only handle sentences that it can <em>generate</em> from it&rsquo;s grammars.<br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†ÄWhat&rsquo;s neat about GF, is that we can express <strong>meaning</strong>, like <code>greeting</code>, by creating an <code>abstract</code> grammar, and then decide how to <strong>manifest</strong> that meaning_, like <em>&ldquo;Hello&rdquo;, &ldquo;Bonjour&rdquo;, &ldquo;N«ê h«éo&rdquo;</em>, by creating <code>concrete</code> grammars for a range of different languages. Later in this post, we&rsquo;ll create an example, where we write gramamrs for a <strong>pizza ordering system</strong>.</p>
<blockquote>
<p><strong>Read More:</strong> For more on GF, check out <a href="https://www.grammaticalframework.org/">the framework&rsquo;s official website</a>.</p>
</blockquote>
<hr>
<h1 id="-get-started-with-gf-on-an-apple-silicon-mac">üî∞ Get started with GF (on an Apple Silicon Mac)</h1>
<blockquote>
<p>GF is available on pretty much every big platform; Windows, Linux, Intel Mac, and Silicon Mac. For the other platforms, please read the installation instructions.</p>
</blockquote>
<p>Now that we have a rough idea of what GF is, let&rsquo;s get it running on our Silicon Mac.
We are going to (1) download the official GF 3.12 binary, (2)  install it, (3) write a simple grammar, use the <em>GF CLI</em> to (4) compile the grammars, and finally (5) try to intergrate the generated grammars in a simple Rust application. Let&rsquo;s get started.</p>
<blockquote>
<p>TODO: &#x1f525; Get the right number of steps listed.</p>
</blockquote>
<h3 id="cat-step-01-get-the-binary">&#x1f431; Step 01: Get the binary</h3>
<p>First we need to grab the Grammatical Framework binary.
Go to <strong><a href="https://www.github.com/gf-core/releases">https://www.github.com/gf-core/releases</a></strong> and downlod the latest release for Apple Silicon Mac (3.12 at this time of writing). The name of the binary should be: <code>gf-3.12-macos-arm.pkg</code> and is about 20 Mbs in size.</p>
<hr>
<h3 id="dog-step-02-install-the-binary">&#x1f436; Step 02: Install the binary</h3>
<p>Locate the downloaded binary, double-click it, and follow the installer instructions.
If everything went well, we now have the <strong>GF CLI</strong> accessible in our terminal.</p>
<blockquote>
<p><strong>Note:</strong> When you double click the installation file, you may get a warning stating that &ldquo;macOS cannot verify the developer of &ldquo;gf-3.12-macos-intel.pkg&rdquo;. Are you sure you want to open it?&rdquo;. Go to your Mac&rsquo;s System Settings, under &lsquo;Privacy &amp; Security&rsquo;, click &ldquo;Open Anyway&rdquo;.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#95a5a6"># In a terminal run:</span>
</span></span><span style="display:flex;"><span>gf version
</span></span><span style="display:flex;"><span>                              
</span></span><span style="display:flex;"><span>         *  *  *              
</span></span><span style="display:flex;"><span>      *           *           
</span></span><span style="display:flex;"><span>    *               *         
</span></span><span style="display:flex;"><span>   *                          
</span></span><span style="display:flex;"><span>   *                          
</span></span><span style="display:flex;"><span>   *        * * * * * *       
</span></span><span style="display:flex;"><span>   *        *         *       
</span></span><span style="display:flex;"><span>    *       * * * *  *        
</span></span><span style="display:flex;"><span>      *     *      *          
</span></span><span style="display:flex;"><span>         *  *  *              
</span></span><span style="display:flex;"><span>                              
</span></span><span style="display:flex;"><span>This is GF version 3.12.0. 
</span></span><span style="display:flex;"><span>Built on darwin/aarch64 with ghc-9.6 at 2025-08-13 12:09:33
</span></span><span style="display:flex;"><span>Git info: commit fa2826d tag 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>Flags: interrupt server c-runtime
</span></span><span style="display:flex;"><span>License: see <span style="color:#728e00">help</span> -license.  
</span></span></code></pre></div><blockquote>
<p><strong>Resource:</strong> For more GF commands, see the Appendix at the end of this post&#x1f447;.</p>
</blockquote>
<hr>
<h3 id="mouse-step-03-dialogue-use-case">&#x1f42d; Step 03: Dialogue Use Case</h3>
<p>In order to test that our installed <code>gf</code> CLI works, we&rsquo;re goign to create a small
grammar and then test it. Everyone loves pizza, so let&rsquo;s create a <strong>Pizza Ordering Grammar</strong>.</p>
<p><strong>The scenario</strong>: We&rsquo;ll start by writing an imaginary <em>User Scenario</em>, as a <em>Wizard of Oz</em>-technique, and then use that scenario to source what needs to be in our grammar. So, imagine the following:<br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä&quot;<em>Eve has been coding all day without breaks, and now she&rsquo;s starving. She decides to order a pizza. Since it&rsquo;s 2025, she does so, right in her <em>Discord</em> chat window. Using the marvels of The Agentic Web, and the fact that she&rsquo;s a member of the PizzaHut Discord server, Eve initiates the diagloue below.</em>&quot;</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#95a5a6"># Discord Dialogue</span>
</span></span><span style="display:flex;"><span>üë©Eve: <span style="color:#7f8c8d">&#34;@PizzaHut, I need your help!&#34;</span>
</span></span><span style="display:flex;"><span>üçïPizzaHut: <span style="color:#7f8c8d">&#34;Hi! Welcome to Pizza Hut! What can I do for you?&#34;</span>
</span></span><span style="display:flex;"><span>üë©Eve: <span style="color:#7f8c8d">&#34;I want to order a pizza.&#34;</span>
</span></span><span style="display:flex;"><span>üçïPizzaHut: <span style="color:#7f8c8d">&#34;Great! Which pizza did you have in mind?&#34;</span>
</span></span><span style="display:flex;"><span>üë©Eve: <span style="color:#7f8c8d">&#34;I want to order a Capriciosa.&#34;</span>
</span></span><span style="display:flex;"><span>üçïPizzaHut: <span style="color:#7f8c8d">&#34;One Capriciosa. Anything else?&#34;</span>
</span></span><span style="display:flex;"><span>üë©Eve: <span style="color:#7f8c8d">&#34;No, thank you. That&#39;s all!&#34;</span>
</span></span><span style="display:flex;"><span>üçïPizzaHut: <span style="color:#7f8c8d">&#34;What addres do you want the pizza delivered to?&#34;</span>
</span></span><span style="display:flex;"><span>üë©Eve: <span style="color:#7f8c8d">&#34;2210, Burbank Street.&#34;</span>
</span></span><span style="display:flex;"><span>üçïPizzaHut: <span style="color:#7f8c8d">&#34;2210, Burbank Street.&#34;</span>
</span></span><span style="display:flex;"><span>üçïPizzaHut: <span style="color:#7f8c8d">&#34;The pizza will be delivered in 30 minutes.&#34;</span>
</span></span><span style="display:flex;"><span>üë© <span style="color:#7f8c8d">&#34;Thank you! Bye!&#34;</span>
</span></span></code></pre></div><p>There are lots of details that we could add, but let&rsquo;s keep things simple for now.
Our intention is not to create a capable system. Our goal is to test out Grammatical Framework 3.12
on our Apple Silicon Mac. Let&rsquo;s proceed.</p>
<!-- 
```shell
üë©Eve: "@PizzaHut, I need your help!" ‚Üí Greeting
üçïPizzaHut: "Hi! Welcome to Pizza Hut! What can I do for you?" ‚Üí Greeting
üë©Eve: "Hi! I want to order a pizza." ‚Üí Order Initiation
üçïPizzaHut: "Great! Which pizza did you have in mind?" ‚Üí Choice
üë©Eve: "I want to order a Capriciosa with extra cheese." ‚Üí Choice
üçïPizzaHut: "One Capriciosa with extra cheese. Anything else?" ‚Üí Confirmation
üë©Eve: "No, thank you. That's all!" ‚Üí Confirmation
üçïPizzaHut: "What addres do you want the pizza delivered to?" ‚Üí Delivery info
üë©Eve: "2210, Burbank Street." ‚Üí Delivery info
üçïPizzaHut: "2210, Burbank Street." ‚Üí Delivery info
üçïPizzaHut: "The pizza will be delivered in about 30 minutes." ‚Üí Delivery info
üçïPizzaHut: "Please have your card ready for payment processing." ‚Üí Payment info
```
-->
<hr>
<h2 id="microscope-step-04-discourse-analysis">&#x1f52c; Step 04: Discourse Analysis</h2>
<p>If we break down the <em>semantic elements</em> in the discourse above, we find
that we can <em>extract</em> <strong>dialogue categories</strong> and <strong>speech acts</strong>. üë©Eve, in expressing; <em>&ldquo;Hi! I want to order a pizza.&rdquo;</em>
performs a <code>Order Initiation</code> dialogue category, and an <code>Expressive/Phatic</code> speech act.
By analyzing the discourse above we can extract which dialogue categories and speech acts that our grammar needs to handle:</p>
<table>
  <thead>
      <tr>
          <th style="text-align: left">Speaker</th>
          <th>Dialogue</th>
          <th>Category</th>
          <th>Speech Act</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">üë©</td>
          <td>&ldquo;@PizzaHut, I need your help!&rdquo;</td>
          <td>Greeting</td>
          <td>Expressive / Phatic</td>
      </tr>
      <tr>
          <td style="text-align: left">üçï</td>
          <td>&ldquo;Hi! Welcome to Pizza Hut!  <br>What can I do for you?&rdquo;</td>
          <td>Greeting</td>
          <td>Expressive / Phatic</td>
      </tr>
      <tr>
          <td style="text-align: left">üë©</td>
          <td>&ldquo;I want to order a pizza.&rdquo;</td>
          <td>Order Initiation</td>
          <td>Directive</td>
      </tr>
      <tr>
          <td style="text-align: left">üçï</td>
          <td>&ldquo;Great! Which pizza did you have in mind?&rdquo;</td>
          <td>Choice</td>
          <td>Directive</td>
      </tr>
      <tr>
          <td style="text-align: left">üë©</td>
          <td>&ldquo;I want to order a Capriciosa.&rdquo;</td>
          <td>Choice</td>
          <td>Directive</td>
      </tr>
      <tr>
          <td style="text-align: left">üçï</td>
          <td>&ldquo;One Capriciosa. <br>Anything else?&rdquo;</td>
          <td>Confirmation</td>
          <td>Commissive / Directive</td>
      </tr>
      <tr>
          <td style="text-align: left">üë©</td>
          <td>&ldquo;No, thank you.&rdquo;</td>
          <td>Confirmation</td>
          <td>Commissive / Assertive</td>
      </tr>
      <tr>
          <td style="text-align: left">üë©</td>
          <td>&ldquo;That&rsquo;s all!&rdquo;</td>
          <td>Order Finalization</td>
          <td>Commissive / Assertive</td>
      </tr>
      <tr>
          <td style="text-align: left">üçï</td>
          <td>&ldquo;What addres do you want the pizza delivered to?&rdquo;</td>
          <td>Delivery info</td>
          <td>Directive</td>
      </tr>
      <tr>
          <td style="text-align: left">üë©</td>
          <td>&ldquo;2210, Burbank Street.&rdquo;</td>
          <td>Delivery info</td>
          <td>Assertive</td>
      </tr>
      <tr>
          <td style="text-align: left">üçï</td>
          <td>&ldquo;2210, Burbank Street.&rdquo;</td>
          <td>Delivery info</td>
          <td>Assertive</td>
      </tr>
      <tr>
          <td style="text-align: left">üçï</td>
          <td>&ldquo;The pizza will be delivered in 30 minutes.&rdquo;</td>
          <td>Delivery info</td>
          <td>Assertive</td>
      </tr>
      <tr>
          <td style="text-align: left">üë©</td>
          <td>&ldquo;Thank you! Bye!&rdquo;</td>
          <td>Farewell</td>
          <td>Expressive / Phatic</td>
      </tr>
  </tbody>
</table>
<blockquote>
<p><strong>Read More:</strong> How <a href="https://en.wikipedia.org/wiki/Speech_act">Speech Act Theory</a> can be used to analyze <em>intentions</em> in sentences.</p>
</blockquote>
<hr>
<h3 id="pen-step-05-write-grammars">&#x1f58a;&#xfe0f; Step 05: Write Grammars</h3>
<p>Now that we have a <em>User Story</em>, analysed for it&rsquo;s <em>Dialogue Categories</em>, and their <em>Speech Acts</em>, let&rsquo;s move on and
create the grammars needed for GF to be able to handle this discourse.<br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä When we say handle, we mean be able to parse strings into Abstract Syntax Trees (representing meaning) and vice versa - linearize ASTs into strings in a natural language. Again, since this example is only for demonstration, we&rsquo;ll keep the grammar small.<br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä  We&rsquo;ll note, however, that crafting performant production grade grammars is a very delicate and complicated task, which requires expert level compentence - far from what
we&rsquo;re doing here.</p>
<h4 id="blue_book-abstract-grammar-file-__pizzaordergf__">&#x1f4d8; Abstract Grammar File: <strong>PizzaOrder.gf</strong></h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span><span style="color:#d35400">abstract</span> <span style="color:#00979d">PizzaOrder</span> <span style="color:#728e00">=</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#434f54">cat</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Conversation</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">PizzeriaGreeting</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">CustomerGreeting</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Order</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Pizza</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">DeliveryDetails</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Quantity</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#434f54">fun</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Dialogue</span> <span style="color:#00979d">:</span> <span style="color:#00979d">PizzeriaGreeting</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">CustomerGreeting</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Order</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">DeliveryDetails</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Conversation</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Greetings</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">HelloPizzeria</span> <span style="color:#00979d">:</span> <span style="color:#00979d">PizzeriaGreeting</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">HelloCustomer</span> <span style="color:#00979d">:</span> <span style="color:#00979d">CustomerGreeting</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Quantities</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">One</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Quantity</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Two</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Quantity</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Three</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Quantity</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Orders</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">SinglePizza</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Quantity</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Pizza</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Order</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">MultipleOrders</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Order</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Order</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Order</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Variants of asking</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">WouldLike</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Order</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Order</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">CanIHave</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Order</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Order</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">IllTake</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Order</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">Order</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Pizza types</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Margherita</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Pizza</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Pepperoni</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Pizza</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">FourCheese</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Pizza</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Delivery details</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">DeliverTo</span> <span style="color:#00979d">:</span> <span style="color:#00979d">Str</span> <span style="color:#728e00">-&gt;</span> <span style="color:#00979d">DeliveryDetails</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">PickUp</span> <span style="color:#00979d">:</span> <span style="color:#00979d">DeliveryDetails</span> ;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="green_book-concrete-grammar-file-__pizzaorderenggf__-england">&#x1f4d7; Concrete Grammar File: <strong>PizzaOrderEng.gf</strong> &#x1f3f4;&#xe0067;&#xe0062;&#xe0065;&#xe006e;&#xe0067;&#xe007f;</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span><span style="color:#d35400">concrete</span> <span style="color:#00979d">PizzaOrderEng</span> <span style="color:#00979d">of</span> <span style="color:#00979d">PizzaOrder</span> <span style="color:#728e00">=</span> <span style="color:#434f54">open</span> <span style="color:#00979d">SyntaxEng</span>, <span style="color:#00979d">LexiconEng</span>, <span style="color:#00979d">ParadigmsEng</span> <span style="color:#00979d">in</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#434f54">lincat</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Conversation</span>, <span style="color:#00979d">PizzeriaGreeting</span>, <span style="color:#00979d">CustomerGreeting</span>, <span style="color:#00979d">Order</span>, <span style="color:#00979d">Pizza</span>, <span style="color:#00979d">DeliveryDetails</span> <span style="color:#728e00">=</span> <span style="color:#00979d">Utt</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Quantity</span> <span style="color:#728e00">=</span> <span style="color:#00979d">Det</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#434f54">lin</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Dialogue</span> <span style="color:#434f54">pg</span> <span style="color:#434f54">cg</span> <span style="color:#434f54">o</span> <span style="color:#434f54">dd</span> <span style="color:#728e00">=</span>
</span></span><span style="display:flex;"><span>      <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> [<span style="color:#434f54">pg</span>, <span style="color:#434f54">cg</span>, <span style="color:#434f54">o</span>, <span style="color:#434f54">dd</span>]) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Greetings</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">HelloPizzeria</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> <span style="color:#7f8c8d">&#34;Hello, this is Luigi&#39;s Pizzeria. How can I help you today?&#34;</span>) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">HelloCustomer</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> <span style="color:#7f8c8d">&#34;Hello, good evening!&#34;</span>) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Quantities</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">One</span> <span style="color:#728e00">=</span> <span style="color:#434f54">a_Det</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Two</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkDet</span> (<span style="color:#434f54">mkNumeral</span> <span style="color:#7f8c8d">&#34;two&#34;</span>) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Three</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkDet</span> (<span style="color:#434f54">mkNumeral</span> <span style="color:#7f8c8d">&#34;three&#34;</span>) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Orders</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">SinglePizza</span> <span style="color:#434f54">q</span> <span style="color:#434f54">p</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkNP</span> <span style="color:#434f54">q</span> <span style="color:#434f54">p</span>) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">MultipleOrders</span> <span style="color:#434f54">o1</span> <span style="color:#434f54">o2</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkNP</span> <span style="color:#434f54">and_Conj</span> (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o1</span>) (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o2</span>)) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Variants</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">WouldLike</span> <span style="color:#434f54">o</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkCl</span> (<span style="color:#434f54">mkNP</span> <span style="color:#00979d">I_Pron</span>) (<span style="color:#434f54">mkVP</span> (<span style="color:#434f54">mkV2</span> <span style="color:#7f8c8d">&#34;like&#34;</span>) (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o</span>))) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">CanIHave</span> <span style="color:#434f54">o</span>  <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkQS</span> (<span style="color:#434f54">mkQCl</span> <span style="color:#434f54">can_VV</span> (<span style="color:#434f54">mkNP</span> <span style="color:#00979d">I_Pron</span>) (<span style="color:#434f54">mkVP</span> <span style="color:#434f54">have_V2</span> (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o</span>)))) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">IllTake</span> <span style="color:#434f54">o</span>   <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkCl</span> (<span style="color:#434f54">mkNP</span> <span style="color:#00979d">I_Pron</span>) (<span style="color:#434f54">mkVP</span> (<span style="color:#434f54">mkV2</span> <span style="color:#7f8c8d">&#34;take&#34;</span>) (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o</span>))) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Pizzas</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Margherita</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkN</span> <span style="color:#7f8c8d">&#34;Margherita pizza&#34;</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Pepperoni</span>  <span style="color:#728e00">=</span> <span style="color:#434f54">mkN</span> <span style="color:#7f8c8d">&#34;Pepperoni pizza&#34;</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">FourCheese</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkN</span> <span style="color:#7f8c8d">&#34;Four Cheese pizza&#34;</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Delivery</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">DeliverTo</span> <span style="color:#434f54">addr</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> (<span style="color:#7f8c8d">&#34;Please deliver it to &#34;</span> <span style="color:#728e00">++</span> <span style="color:#434f54">addr</span>)) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">PickUp</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> <span style="color:#7f8c8d">&#34;I will pick it up myself.&#34;</span>) ;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h4 id="orange_book-concrete-grammar-file-__pizzaorderfregf__-">&#x1f4d9; Concrete Grammar File: <strong>PizzaOrderFre.gf</strong> üá´üá∑</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-haskell" data-lang="haskell"><span style="display:flex;"><span><span style="color:#d35400">concrete</span> <span style="color:#00979d">PizzaOrderFre</span> <span style="color:#00979d">of</span> <span style="color:#00979d">PizzaOrder</span> <span style="color:#728e00">=</span> <span style="color:#434f54">open</span> <span style="color:#00979d">SyntaxFre</span>, <span style="color:#00979d">LexiconFre</span>, <span style="color:#00979d">ParadigmsFre</span> <span style="color:#00979d">in</span> {
</span></span><span style="display:flex;"><span>  <span style="color:#434f54">lincat</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Conversation</span>, <span style="color:#00979d">PizzeriaGreeting</span>, <span style="color:#00979d">CustomerGreeting</span>, <span style="color:#00979d">Order</span>, <span style="color:#00979d">Pizza</span>, <span style="color:#00979d">DeliveryDetails</span> <span style="color:#728e00">=</span> <span style="color:#00979d">Utt</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Quantity</span> <span style="color:#728e00">=</span> <span style="color:#00979d">Det</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#434f54">lin</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Dialogue</span> <span style="color:#434f54">pg</span> <span style="color:#434f54">cg</span> <span style="color:#434f54">o</span> <span style="color:#434f54">dd</span> <span style="color:#728e00">=</span>
</span></span><span style="display:flex;"><span>      <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> [<span style="color:#434f54">pg</span>, <span style="color:#434f54">cg</span>, <span style="color:#434f54">o</span>, <span style="color:#434f54">dd</span>]) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Greetings</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">HelloPizzeria</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> <span style="color:#7f8c8d">&#34;Bonjour, ici la pizzeria Luigi. Que puis-je faire pour vous ?&#34;</span>) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">HelloCustomer</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> <span style="color:#7f8c8d">&#34;Bonjour, bonsoir !&#34;</span>) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Quantities</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">One</span> <span style="color:#728e00">=</span> <span style="color:#434f54">un_Det</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Two</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkDet</span> (<span style="color:#434f54">mkNumeral</span> <span style="color:#7f8c8d">&#34;deux&#34;</span>) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Three</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkDet</span> (<span style="color:#434f54">mkNumeral</span> <span style="color:#7f8c8d">&#34;trois&#34;</span>) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Orders</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">SinglePizza</span> <span style="color:#434f54">q</span> <span style="color:#434f54">p</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkNP</span> <span style="color:#434f54">q</span> <span style="color:#434f54">p</span>) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">MultipleOrders</span> <span style="color:#434f54">o1</span> <span style="color:#434f54">o2</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkNP</span> <span style="color:#434f54">et_Conj</span> (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o1</span>) (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o2</span>)) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Variants</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">WouldLike</span> <span style="color:#434f54">o</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkCl</span> (<span style="color:#434f54">mkNP</span> <span style="color:#00979d">I_Pron</span>) (<span style="color:#434f54">mkVP</span> (<span style="color:#434f54">mkV2</span> <span style="color:#7f8c8d">&#34;vouloir&#34;</span>) (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o</span>))) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">CanIHave</span> <span style="color:#434f54">o</span>  <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkQS</span> (<span style="color:#434f54">mkQCl</span> (<span style="color:#434f54">mkVP</span> (<span style="color:#434f54">mkV2</span> <span style="color:#7f8c8d">&#34;pouvoir&#34;</span>) (<span style="color:#434f54">mkVP</span> (<span style="color:#434f54">mkV2</span> <span style="color:#7f8c8d">&#34;avoir&#34;</span>) (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o</span>)))))) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">IllTake</span> <span style="color:#434f54">o</span>   <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkCl</span> (<span style="color:#434f54">mkNP</span> <span style="color:#00979d">I_Pron</span>) (<span style="color:#434f54">mkVP</span> (<span style="color:#434f54">mkV2</span> <span style="color:#7f8c8d">&#34;prendre&#34;</span>) (<span style="color:#434f54">fromUtt</span> <span style="color:#434f54">o</span>))) ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Pizzas</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Margherita</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkN</span> <span style="color:#7f8c8d">&#34;pizza Margherita&#34;</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">Pepperoni</span>  <span style="color:#728e00">=</span> <span style="color:#434f54">mkN</span> <span style="color:#7f8c8d">&#34;pizza Pepperoni&#34;</span> ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">FourCheese</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkN</span> <span style="color:#7f8c8d">&#34;pizza quatre fromages&#34;</span> ;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">-- Delivery</span>
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">DeliverTo</span> <span style="color:#434f54">addr</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> (<span style="color:#7f8c8d">&#34;Merci de livrer √† &#34;</span> <span style="color:#728e00">++</span> <span style="color:#434f54">addr</span>)) ;
</span></span><span style="display:flex;"><span>    <span style="color:#00979d">PickUp</span> <span style="color:#728e00">=</span> <span style="color:#434f54">mkUtt</span> (<span style="color:#434f54">mkText</span> <span style="color:#7f8c8d">&#34;Je viendrai la chercher moi-m√™me.&#34;</span>) ;
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h3 id="wrench-step-06-compile-grammars">&#x1f527; Step 06: Compile Grammars</h3>
<p>Before we can actually use the grammars that we have written, we have to <em>compile</em> them using GF.
But what does <em>compiling a grammar</em> really mean?<br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä One of the main strengths of Grammatical Framework, is its ability to create  Abstract Syntax Trees (AST). An AST can be seen as the <em>syntactic</em> representation of a natural language sentence.
We could even, somewhat hand-wavey, think of the AST as the <em>meaning</em> of a sentence.
What is not hand-wavey is the ASTs function as a an <em>interlingua</em> between grammars
of different languages (for example English and French). The AST is what makes it possible for GF to translate
a sentence in one langauge &ldquo;I want to order a pizza!&rdquo; into another language &ldquo;Je veux commander une pizza !&rdquo;.<br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä So, let&rsquo;s use GF to create an AST for the gramars that we wrote earlier, and translate a sentence between English and French:</p>
<p><strong>6.1.</strong> Compile the Abstract, English, and French grammars into an Abstract Syntax Tree (AST)</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gf PizzaOrder.gf PizzaOrderEng.gf PizzaOrderFre.gf
</span></span></code></pre></div><p><strong>6.2.</strong> Parse an english sentence and generate its AST</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>parse -lang<span style="color:#728e00">=</span>Eng <span style="color:#7f8c8d">&#34;Hello, this is Luigi&#39;s Pizzeria. 
</span></span></span><span style="display:flex;"><span><span style="color:#7f8c8d">How can I help you today? Hello, good evening! 
</span></span></span><span style="display:flex;"><span><span style="color:#7f8c8d">I would like a Margherita pizza and a Pepperoni pizza 
</span></span></span><span style="display:flex;"><span><span style="color:#7f8c8d">Please deliver it to 221B Baker Street.&#34;</span>
</span></span></code></pre></div><p>which returns:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Dialogue HelloPizzeria HelloCustomer 
</span></span><span style="display:flex;"><span>  <span style="color:#728e00">(</span>MultiplePizzas Margherita <span style="color:#728e00">(</span>SinglePizza Pepperoni<span style="color:#728e00">))</span> 
</span></span><span style="display:flex;"><span>  <span style="color:#728e00">(</span>DeliverTo <span style="color:#7f8c8d">&#34;221B Baker Street&#34;</span><span style="color:#728e00">)</span>
</span></span></code></pre></div><p><strong>6.3.</strong> Linearize an AST into French</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>linearize -lang<span style="color:#728e00">=</span>Fre Dialogue HelloPizzeria HelloCustomer 
</span></span><span style="display:flex;"><span><span style="color:#728e00">(</span>MultiplePizzas Margherita <span style="color:#728e00">(</span>SinglePizza Pepperoni<span style="color:#728e00">))</span> 
</span></span><span style="display:flex;"><span><span style="color:#728e00">(</span>DeliverTo <span style="color:#7f8c8d">&#34;221B Baker Street&#34;</span><span style="color:#728e00">)</span>
</span></span></code></pre></div><p>which returns:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>Bonjour, ici la pizzeria Luigi. Que puis-je faire pour vous ?
</span></span><span style="display:flex;"><span>Bonjour, bonsoir !
</span></span><span style="display:flex;"><span>Je voudrais une pizza Margherita et une pizza Pepperoni Merci 
</span></span><span style="display:flex;"><span>de livrer √† 221B Baker Street.
</span></span></code></pre></div><p>Great! Our GF grammar can <em>parse</em> and <em>linearise</em> sentences.<br>
But we want to <em>use</em> our grammars in an application - not just in the terminal.
So, for our next step, we&rsquo;ll make our grammars <strong>portable</strong>, so that they can be used
in other non-GF environmants<br>
- for example, in a Rust program.</p>
<!--
### :pickaxe: Interlude: creation of a tool: `pgf2json`
> __Important:__ For this next step we need a tool that is provided by GF, called `pgf2json`. The pgf2json utility comes packaged with the GF installation, together with the GF CLI), and so we don't need to install it separately

__1.__ Create a file called pgf2json.sh
```shell
nano pgf2json.sh
```
__2.__ Paste this content inside
```shell
#!/bin/bash
# Usage: ./pgf2json.sh grammar.pgf > grammar.json

if [ -z "$1" ]; then
  echo "Usage: $0 <file.pgf>"
  exit 1
fi

gf --run "$1" <<< ":i --format=json"
```
__3.__ Make it executable
```shell
chmod +x pgf2json.sh
```
__4.__ Use it like the real tool
```shell
./pgf2json.sh Hello.pgf > Hello.json
```

__5.__ Add it to our `PATH` for each access
```shell
sudo mv pgf2json.sh /usr/local/bin/pgf2json
# Now we can call the tool, like so:
pgf2json Hello.pgf > Hello.json
```
---
-->
<hr>
<h3 id="toolbox-step-07-make-the-grammars-portable">&#x1f9f0; Step 07: Make the Grammars Portable</h3>
<p>Portable Grammar Format (PGF) is to GF, what &ldquo;bytecode is to Java&rdquo;, and the recommended format
in which final grammar products should be distributed. The reason is that PGF grammars are
stripped from superfluous information, which results in faster processing.<br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä On the application side, just as with Java bytecode, it should never be necessary
to edit PGF files. They are ready to be embedded in other programs.
Having written our grammar and created the AST, we now use the GF compiler
to transform it into the <code>.pgf</code> file format. The steps are easy:</p>
<p><strong>7.1</strong> Compile the grammars into <strong>Pizza.pgf</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>gf --make PizzaEng.gf PizzaFre.gf
</span></span></code></pre></div><p>The resulting file, Pizza.pgf, is in PGF <em>binary code</em> format, which means that
we cannot, in contrast to the other grammars (Pizza.gf, PizzaEng.gf, and PizzaFre.gf)
simply open and read it - it would just appear as gibberish.</p>
<p>To use the compiled <code>Pizza.pgf</code> file we need a <strong>runtime</strong>. GF provides runtimes
for most popular languages (Java, Python, C, C#, Haskell). These runtimes enable
developers to use the GF grammars without having to install GF on their computers.</p>
<p><strong>7.2A</strong> Improving Portability with JSON: <strong>Pizza.json</strong><br>
The PGF file format is great, but in the web era, JSON (and XML) is surely the
most popular format for representing interchange data. So, let&rsquo;s try to get our
compiled <code>Pizza.pgf</code> grammar converted into a <code>Pizza.json</code> file.
That way, it becomes portable <em>and</em> its content easily viewable.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#95a5a6"># Translate Pizza.pgf into Pizza.json format</span>
</span></span><span style="display:flex;"><span><span style="color:#95a5a6"># In a folder where we have our Pizza.pgf file, run:</span>
</span></span><span style="display:flex;"><span>gf -make --output-format<span style="color:#728e00">=</span>json PizzaEng.gf PizzaFre.gf
</span></span></code></pre></div><blockquote>
<p><strong>Slow Compilation?:</strong> For large grammars, memory can be an issue. We can increasing the memory allocation used during compilation by using the <code>+RTS -K500M flag</code>:<br> gf -make &ndash;output-format=json PizzaEng.gf PizzaFre.gf +RTS -K500M</p>
</blockquote>
<p><strong>7.2B</strong> An experimental script for converting PGF to JSON<br>
I had a lot of trouble, trying to translate <code>.pgf</code> to <code>.json</code>. There seem to be
breaking changes between GF 3.11 and GF 3.12, in terms of if and how linearizations
are stored in a <code>.pgf</code> generated from running <code>gf -make *.gf</code>.
‚†Ä‚†Ä‚†Ä‚†Ä‚†ÄAfter a lot of trial and error, I now have a <strong>Pyton script</strong> which appears
to be able to convert a GF 3.12 <code>.pgf</code> file into readable <code>.json</code>.<br>
The script is called <strong>pgf2json</strong>, and I&rsquo;m sharing it below:</p>
<blockquote>
<p><strong>Warning:</strong> This script has <em>not(!)</em> been thoroughly tested, and may generate errors.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-python" data-lang="python"><span style="display:flex;"><span><span style="color:#95a5a6"># File: pgf2json</span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">import</span> <span style="color:#434f54">pgf</span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">import</span> <span style="color:#434f54">json</span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">import</span> <span style="color:#434f54">sys</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">def</span> <span style="color:#d35400">pgf_to_json</span>(<span style="color:#434f54">pgf_file</span>, <span style="color:#434f54">json_file</span>):
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Load PGF grammar</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">pgf_grammar</span> <span style="color:#728e00">=</span> <span style="color:#434f54">pgf</span><span style="color:#728e00">.</span><span style="color:#434f54">readPGF</span>(<span style="color:#434f54">pgf_file</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Categories (filter to only those in the abstract grammar)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">categories</span> <span style="color:#728e00">=</span> [<span style="color:#7f8c8d">&#34;Greeting&#34;</span>, <span style="color:#7f8c8d">&#34;Recipient&#34;</span>]  <span style="color:#95a5a6"># Explicitly list categories from Hello.gf</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">lincats</span> <span style="color:#728e00">=</span> {}
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Use the first concrete syntax to get lincat types</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">first_lang</span> <span style="color:#728e00">=</span> <span style="color:#728e00">list</span>(<span style="color:#434f54">pgf_grammar</span><span style="color:#728e00">.</span><span style="color:#434f54">languages</span><span style="color:#728e00">.</span><span style="color:#434f54">keys</span>())[<span style="color:#8a7b52">0</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">concrete</span> <span style="color:#728e00">=</span> <span style="color:#434f54">pgf_grammar</span><span style="color:#728e00">.</span><span style="color:#434f54">languages</span>[<span style="color:#434f54">first_lang</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">for</span> <span style="color:#434f54">cat</span> <span style="color:#728e00">in</span> <span style="color:#434f54">categories</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">try</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#95a5a6"># Assume Str for known categories based on HelloEng.gf and HelloIta.gf</span>
</span></span><span style="display:flex;"><span>            <span style="color:#434f54">lincats</span>[<span style="color:#434f54">cat</span>] <span style="color:#728e00">=</span> <span style="color:#7f8c8d">&#34;Str&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">except</span> <span style="color:#434f54">Exception</span> <span style="color:#728e00">as</span> <span style="color:#434f54">e</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#434f54">lincats</span>[<span style="color:#434f54">cat</span>] <span style="color:#728e00">=</span> <span style="color:#7f8c8d">f</span><span style="color:#7f8c8d">&#34;&lt;error: </span><span style="color:#7f8c8d">{</span><span style="color:#434f54">e</span><span style="color:#7f8c8d">}</span><span style="color:#7f8c8d">&gt;&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Functions</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">functions</span> <span style="color:#728e00">=</span> []
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">for</span> <span style="color:#434f54">fun</span> <span style="color:#728e00">in</span> <span style="color:#434f54">pgf_grammar</span><span style="color:#728e00">.</span><span style="color:#434f54">functions</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">fun_name</span> <span style="color:#728e00">=</span> <span style="color:#728e00">str</span>(<span style="color:#434f54">fun</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">functions</span><span style="color:#728e00">.</span><span style="color:#434f54">append</span>(<span style="color:#434f54">fun_name</span>)
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Sort functions to match desired order</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">desired_order</span> <span style="color:#728e00">=</span> [<span style="color:#7f8c8d">&#34;Hello&#34;</span>, <span style="color:#7f8c8d">&#34;World&#34;</span>, <span style="color:#7f8c8d">&#34;Mum&#34;</span>, <span style="color:#7f8c8d">&#34;Friends&#34;</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">functions</span><span style="color:#728e00">.</span><span style="color:#434f54">sort</span>(<span style="color:#434f54">key</span><span style="color:#728e00">=</span><span style="color:#728e00">lambda</span> <span style="color:#434f54">x</span>: <span style="color:#434f54">desired_order</span><span style="color:#728e00">.</span><span style="color:#434f54">index</span>(<span style="color:#434f54">x</span>) <span style="color:#728e00">if</span> <span style="color:#434f54">x</span> <span style="color:#728e00">in</span> <span style="color:#434f54">desired_order</span> <span style="color:#728e00">else</span> <span style="color:#728e00">len</span>(<span style="color:#434f54">desired_order</span>))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Start category</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">startcat</span> <span style="color:#728e00">=</span> <span style="color:#728e00">str</span>(<span style="color:#434f54">pgf_grammar</span><span style="color:#728e00">.</span><span style="color:#434f54">startCat</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Languages (concrete syntaxes)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">languages</span> <span style="color:#728e00">=</span> <span style="color:#728e00">list</span>(<span style="color:#434f54">pgf_grammar</span><span style="color:#728e00">.</span><span style="color:#434f54">languages</span><span style="color:#728e00">.</span><span style="color:#434f54">keys</span>())
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Linearizations per language</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">linearizations</span> <span style="color:#728e00">=</span> {}
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">for</span> <span style="color:#434f54">lang</span> <span style="color:#728e00">in</span> <span style="color:#434f54">languages</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">lin_dict</span> <span style="color:#728e00">=</span> {}
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">concrete</span> <span style="color:#728e00">=</span> <span style="color:#434f54">pgf_grammar</span><span style="color:#728e00">.</span><span style="color:#434f54">languages</span>[<span style="color:#434f54">lang</span>]
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">for</span> <span style="color:#434f54">fun</span> <span style="color:#728e00">in</span> <span style="color:#434f54">functions</span>:
</span></span><span style="display:flex;"><span>            <span style="color:#728e00">try</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#434f54">fun_type</span> <span style="color:#728e00">=</span> <span style="color:#434f54">pgf_grammar</span><span style="color:#728e00">.</span><span style="color:#434f54">functionType</span>(<span style="color:#434f54">fun</span>)
</span></span><span style="display:flex;"><span>                <span style="color:#728e00">if</span> <span style="color:#434f54">fun_type</span><span style="color:#728e00">.</span><span style="color:#434f54">cat</span> <span style="color:#728e00">==</span> <span style="color:#7f8c8d">&#34;Greeting&#34;</span> <span style="color:#728e00">and</span> <span style="color:#434f54">fun_type</span><span style="color:#728e00">.</span><span style="color:#434f54">hypos</span>:  <span style="color:#95a5a6"># Function takes arguments (e.g., Hello : Recipient -&gt; Greeting)</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#95a5a6"># Linearize with a dummy Recipient</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#434f54">expr</span> <span style="color:#728e00">=</span> <span style="color:#434f54">pgf</span><span style="color:#728e00">.</span><span style="color:#434f54">Expr</span>(<span style="color:#434f54">fun</span>, [<span style="color:#434f54">pgf</span><span style="color:#728e00">.</span><span style="color:#434f54">Expr</span>(<span style="color:#7f8c8d">&#34;World&#34;</span>, [])])
</span></span><span style="display:flex;"><span>                    <span style="color:#434f54">linearized</span> <span style="color:#728e00">=</span> <span style="color:#434f54">concrete</span><span style="color:#728e00">.</span><span style="color:#434f54">linearize</span>(<span style="color:#434f54">expr</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#95a5a6"># Replace the dummy Recipient (e.g., &#34;world&#34;) with &#34;&lt;Recipient&gt;&#34;</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#728e00">for</span> <span style="color:#434f54">recip</span> <span style="color:#728e00">in</span> [<span style="color:#7f8c8d">&#34;World&#34;</span>, <span style="color:#7f8c8d">&#34;Mum&#34;</span>, <span style="color:#7f8c8d">&#34;Friends&#34;</span>]:
</span></span><span style="display:flex;"><span>                        <span style="color:#434f54">recip_lin</span> <span style="color:#728e00">=</span> <span style="color:#434f54">concrete</span><span style="color:#728e00">.</span><span style="color:#434f54">linearize</span>(<span style="color:#434f54">pgf</span><span style="color:#728e00">.</span><span style="color:#434f54">Expr</span>(<span style="color:#434f54">recip</span>, []))
</span></span><span style="display:flex;"><span>                        <span style="color:#434f54">linearized</span> <span style="color:#728e00">=</span> <span style="color:#434f54">linearized</span><span style="color:#728e00">.</span><span style="color:#434f54">replace</span>(<span style="color:#434f54">recip_lin</span>, <span style="color:#7f8c8d">&#34;&lt;Recipient&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>                    <span style="color:#434f54">lin_dict</span>[<span style="color:#434f54">fun</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">linearized</span>
</span></span><span style="display:flex;"><span>                <span style="color:#728e00">else</span>:
</span></span><span style="display:flex;"><span>                    <span style="color:#95a5a6"># Parameterless functions (e.g., World, Mum, Friends)</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#434f54">lin_dict</span>[<span style="color:#434f54">fun</span>] <span style="color:#728e00">=</span> <span style="color:#728e00">str</span>(<span style="color:#434f54">concrete</span><span style="color:#728e00">.</span><span style="color:#434f54">linearize</span>(<span style="color:#434f54">pgf</span><span style="color:#728e00">.</span><span style="color:#434f54">Expr</span>(<span style="color:#434f54">fun</span>, [])))
</span></span><span style="display:flex;"><span>            <span style="color:#728e00">except</span> <span style="color:#434f54">Exception</span> <span style="color:#728e00">as</span> <span style="color:#434f54">e</span>:
</span></span><span style="display:flex;"><span>                <span style="color:#434f54">lin_dict</span>[<span style="color:#434f54">fun</span>] <span style="color:#728e00">=</span> <span style="color:#7f8c8d">f</span><span style="color:#7f8c8d">&#34;&lt;Linearization error: </span><span style="color:#7f8c8d">{</span><span style="color:#434f54">e</span><span style="color:#7f8c8d">}</span><span style="color:#7f8c8d">&gt;&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">linearizations</span>[<span style="color:#434f54">lang</span>] <span style="color:#728e00">=</span> <span style="color:#434f54">lin_dict</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Build JSON data</span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">data</span> <span style="color:#728e00">=</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#7f8c8d">&#34;languages&#34;</span>: <span style="color:#434f54">languages</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#7f8c8d">&#34;startcat&#34;</span>: <span style="color:#434f54">startcat</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#7f8c8d">&#34;categories&#34;</span>: <span style="color:#434f54">categories</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#7f8c8d">&#34;functions&#34;</span>: <span style="color:#434f54">functions</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#7f8c8d">&#34;lincats&#34;</span>: <span style="color:#434f54">lincats</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#7f8c8d">&#34;linearizations&#34;</span>: <span style="color:#434f54">linearizations</span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6"># Write JSON</span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">with</span> <span style="color:#728e00">open</span>(<span style="color:#434f54">json_file</span>, <span style="color:#7f8c8d">&#34;w&#34;</span>, <span style="color:#434f54">encoding</span><span style="color:#728e00">=</span><span style="color:#7f8c8d">&#34;utf-8&#34;</span>) <span style="color:#728e00">as</span> <span style="color:#434f54">f</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">json</span><span style="color:#728e00">.</span><span style="color:#434f54">dump</span>(<span style="color:#434f54">data</span>, <span style="color:#434f54">f</span>, <span style="color:#434f54">ensure_ascii</span><span style="color:#728e00">=</span><span style="color:#00979d">False</span>, <span style="color:#434f54">indent</span><span style="color:#728e00">=</span><span style="color:#8a7b52">2</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">print</span>(<span style="color:#7f8c8d">f</span><span style="color:#7f8c8d">&#34;Successfully wrote </span><span style="color:#7f8c8d">{</span><span style="color:#434f54">json_file</span><span style="color:#7f8c8d">}</span><span style="color:#7f8c8d"> with </span><span style="color:#7f8c8d">{</span><span style="color:#728e00">len</span>(<span style="color:#434f54">functions</span>)<span style="color:#7f8c8d">}</span><span style="color:#7f8c8d"> functions and </span><span style="color:#7f8c8d">{</span><span style="color:#728e00">len</span>(<span style="color:#434f54">categories</span>)<span style="color:#7f8c8d">}</span><span style="color:#7f8c8d"> categories.&#34;</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">if</span> <span style="color:#434f54">__name__</span> <span style="color:#728e00">==</span> <span style="color:#7f8c8d">&#34;__main__&#34;</span>:
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">if</span> <span style="color:#728e00">len</span>(<span style="color:#434f54">sys</span><span style="color:#728e00">.</span><span style="color:#434f54">argv</span>) <span style="color:#728e00">!=</span> <span style="color:#8a7b52">3</span>:
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">print</span>(<span style="color:#7f8c8d">&#34;Usage: python3 grkpgf2json.py &lt;input.pgf&gt; &lt;output.json&gt;&#34;</span>)
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">sys</span><span style="color:#728e00">.</span><span style="color:#434f54">exit</span>(<span style="color:#8a7b52">1</span>)
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">pgf_file</span> <span style="color:#728e00">=</span> <span style="color:#434f54">sys</span><span style="color:#728e00">.</span><span style="color:#434f54">argv</span>[<span style="color:#8a7b52">1</span>]
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">json_file</span> <span style="color:#728e00">=</span> <span style="color:#434f54">sys</span><span style="color:#728e00">.</span><span style="color:#434f54">argv</span>[<span style="color:#8a7b52">2</span>]
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">pgf_to_json</span>(<span style="color:#434f54">pgf_file</span>, <span style="color:#434f54">json_file</span>)
</span></span></code></pre></div><p><strong>run the script like so:</strong></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#95a5a6"># In a folder containing Pizza.pgf, Pizza.json is our chosen output filename.</span>
</span></span><span style="display:flex;"><span>python3 pgf2json.py Pizza.pgf Pizza.json
</span></span></code></pre></div><hr>
<h3 id="mushroom-interlude-rgl">&#x1f344; Interlude: RGL</h3>
<p>Right now, the English/French concrete syntaxes just concatenate strings, which makes parsing impossible. Instead, we should use GF Resource Grammar Library (RGL), which gives us syntax constructors for phrases, clauses, greetings, etc. That way, GF knows how to go both ways.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>which gf
</span></span><span style="display:flex;"><span><span style="color:#95a5a6"># Should show: /usr/local/bin/gf</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#95a5a6"># Check if RGL is installed.</span>
</span></span><span style="display:flex;"><span>ls /usr/share/gf/lib/
</span></span></code></pre></div><p>The RGL is typically bundled with GF or available as a separate download.
If the RGL is missing, we need to install it.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#95a5a6"># Clone the RGL repository:</span>
</span></span><span style="display:flex;"><span><span style="color:#95a5a6">#git clone https://github.com/GrammaticalFramework/gf-rgl.git ~/gf-rgl</span>
</span></span><span style="display:flex;"><span>git clone https://github.com/GrammaticalFramework/gf-rgl.git ~/tmp/gf-rgl
</span></span><span style="display:flex;"><span>sudo mkdir -p /usr/local/share/gf/lib
</span></span><span style="display:flex;"><span>sudo cp -r ~/tmp/gf-rgl/src/* /usr/local/share/gf/lib/
</span></span><span style="display:flex;"><span>  <span style="color:#95a5a6"># Set the GF_LIB_PATH to include the RGL directory:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#95a5a6">#export GF_LIB_PATH=~/gf-rgl/src</span>
</span></span><span style="display:flex;"><span><span style="color:#95a5a6"># Persist environment variable (~/.zshrc or ~/.bashrc)</span>
</span></span><span style="display:flex;"><span><span style="color:#95a5a6"># echo &#39;export GF_LIB_PATH=~/tmp/gf-rgl/src&#39; &gt;&gt; ~/.zshrc</span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">echo</span> <span style="color:#7f8c8d">&#39;export GF_LIB_PATH=/usr/local/share/gf/lib&#39;</span> &gt;&gt; ~/.zshrc
</span></span><span style="display:flex;"><span><span style="color:#728e00">source</span> ~/.zshrc
</span></span></code></pre></div><hr>
<h2 id="crab-step-08-use-the-pizzajson-grammar-in-an-application">&#x1f980; Step 08: Use the Pizza.json Grammar in an Application</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#728e00">use</span> <span style="color:#434f54">gf_core</span>::<span style="color:#728e00">*</span>;
</span></span><span style="display:flex;"><span><span style="color:#728e00">use</span> <span style="color:#434f54">std</span>::<span style="color:#434f54">fs</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">fn</span> <span style="color:#d35400">main</span>() -&gt; <span style="color:#728e00">Result</span><span style="color:#728e00">&lt;</span>(), <span style="color:#728e00">Box</span><span style="color:#728e00">&lt;</span><span style="color:#728e00">dyn</span> <span style="color:#434f54">std</span>::<span style="color:#434f54">error</span>::<span style="color:#434f54">Error</span><span style="color:#728e00">&gt;&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">// Load a PGF grammar from JSON file
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#728e00">let</span> <span style="color:#434f54">json_content</span> <span style="color:#728e00">=</span> <span style="color:#434f54">fs</span>::<span style="color:#434f54">read_to_string</span>(<span style="color:#7f8c8d">&#34;grammars/Pizza.json&#34;</span>)<span style="color:#728e00">?</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">let</span> <span style="color:#434f54">json</span>: <span style="color:#434f54">serde_json</span>::<span style="color:#434f54">Value</span> <span style="color:#728e00">=</span> <span style="color:#434f54">serde_json</span>::<span style="color:#434f54">from_str</span>(<span style="color:#728e00">&amp;</span><span style="color:#434f54">json_content</span>)<span style="color:#728e00">?</span>;
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">let</span> <span style="color:#434f54">pgf</span>: <span style="color:#434f54">PGF</span> <span style="color:#728e00">=</span> <span style="color:#434f54">serde_json</span>::<span style="color:#434f54">from_value</span>(<span style="color:#434f54">json</span>)<span style="color:#728e00">?</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">// Convert to runtime grammar
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#728e00">let</span> <span style="color:#434f54">grammar</span> <span style="color:#728e00">=</span> <span style="color:#434f54">GFGrammar</span>::<span style="color:#434f54">from_json</span>(<span style="color:#434f54">pgf</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">// Parse an abstract syntax tree from string
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#728e00">let</span> <span style="color:#434f54">tree</span> <span style="color:#728e00">=</span> <span style="color:#434f54">grammar</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#434f54">abstract_grammar</span>
</span></span><span style="display:flex;"><span>        .<span style="color:#434f54">parse_tree</span>(<span style="color:#7f8c8d">&#34;Bonjour, ici la pizzeria Luigi. Que puis-je faire pour vous ?&#34;</span>, <span style="color:#728e00">None</span>)
</span></span><span style="display:flex;"><span>        .<span style="color:#434f54">expect</span>(<span style="color:#7f8c8d">&#34;Failed to parse tree&#34;</span>);
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">println!</span>(<span style="color:#7f8c8d">&#34;Parsed tree: </span><span style="color:#7f8c8d">{}</span><span style="color:#7f8c8d">&#34;</span>, <span style="color:#434f54">tree</span>.<span style="color:#434f54">print</span>());
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">// Linearize the tree in English
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#728e00">if</span> <span style="color:#728e00">let</span> <span style="color:#728e00">Some</span>(<span style="color:#434f54">eng_concrete</span>) <span style="color:#728e00">=</span> <span style="color:#434f54">grammar</span>.<span style="color:#434f54">concretes</span>.<span style="color:#434f54">get</span>(<span style="color:#7f8c8d">&#34;PizzaEng&#34;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">let</span> <span style="color:#434f54">english_output</span> <span style="color:#728e00">=</span> <span style="color:#434f54">eng_concrete</span>.<span style="color:#434f54">linearize</span>(<span style="color:#728e00">&amp;</span><span style="color:#434f54">tree</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">println!</span>(<span style="color:#7f8c8d">&#34;English: </span><span style="color:#7f8c8d">{}</span><span style="color:#7f8c8d">&#34;</span>, <span style="color:#434f54">english_output</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">// Linearize the tree in French
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#728e00">if</span> <span style="color:#728e00">let</span> <span style="color:#728e00">Some</span>(<span style="color:#434f54">fre_concrete</span>) <span style="color:#728e00">=</span> <span style="color:#434f54">grammar</span>.<span style="color:#434f54">concretes</span>.<span style="color:#434f54">get</span>(<span style="color:#7f8c8d">&#34;PizzaFre&#34;</span>) {
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">let</span> <span style="color:#434f54">french_output</span> <span style="color:#728e00">=</span> <span style="color:#434f54">fre_concrete</span>.<span style="color:#434f54">linearize</span>(<span style="color:#728e00">&amp;</span><span style="color:#434f54">tree</span>);
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">println!</span>(<span style="color:#7f8c8d">&#34;French: </span><span style="color:#7f8c8d">{}</span><span style="color:#7f8c8d">&#34;</span>, <span style="color:#434f54">french_output</span>);
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">Ok</span>(())
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><hr>
<h2 id="bath-end-note-whats-next">&#x1f6c0; End Note: What&rsquo;s Next?</h2>
<p>We&rsquo;ve only scratched the surface of Grammatical Framework. The system has been
developed by sharp CS Ph.D.s and a professors for almost a decade.<br>
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä One area that I&rsquo;m personally looking at, is using LLMs as &lsquo;middleware&rsquo; in a GF
gramamr dialogue system. Manually crafting grammars is quite tricky, and so LLMs
could be used to both simplify the process, but also add &lsquo;color&rsquo; to linearizations.</p>
<hr>
<h2 id="compass-appendix-gf-commands">&#x1f9ed; Appendix: GF Commands</h2>
<table>
  <thead>
      <tr>
          <th style="text-align: left">short</th>
          <th style="text-align: left">command</th>
          <th style="text-align: left">action</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: left">i</td>
          <td style="text-align: left">import *.gf</td>
          <td style="text-align: left">compile the grammar into an internal representation</td>
      </tr>
      <tr>
          <td style="text-align: left">p</td>
          <td style="text-align: left">parse *.gf</td>
          <td style="text-align: left">turns <code>string</code> into an <code>abstract syntax tree</code>: parse &ldquo;hello world&rdquo; -&gt; Hello World</td>
      </tr>
      <tr>
          <td style="text-align: left">l</td>
          <td style="text-align: left">linearise *.gf</td>
          <td style="text-align: left">turns <code>abstract syntax trees</code> into <code>strings</code>:  linearize Hello World -&gt; &ldquo;hello world&rdquo;</td>
      </tr>
  </tbody>
</table>
<hr>
<h2 id="fire-troubleshooting">&#x1f525; TroubleShooting</h2>
<p>On macOS (especially Apple Silicon), the GF source distribution includes the Python bindings, but they‚Äôre not built automatically. We&rsquo;ll need to go into the right folder in the source tree,
and build it ourselves.</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#728e00">cd</span> /Downloads/gf-core-master/src/runtime/python
</span></span><span style="display:flex;"><span><span style="color:#95a5a6"># Instsall bindings:  </span>
</span></span><span style="display:flex;"><span>python3 setup.py install --user
</span></span><span style="display:flex;"><span><span style="color:#95a5a6"># Verify build was successful:</span>
</span></span><span style="display:flex;"><span>python3 -c <span style="color:#7f8c8d">&#34;import pgf; print(pgf.__file__)&#34;</span>
</span></span></code></pre></div>



    </div>
    
    
  </div>
</section>

<section class="section">
  <div class="container has-text-centered">
    <p>'I write to understand as much as to be understood.' ‚ÄîElie Wiesel<br> (c) 2024 CryptoPatrick</p>
  </div>
</section>

<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.0/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




</body>
