<!DOCTYPE html>
<html lang="en-EN">
<head><script src="/livereload.js?mindelay=10&amp;v=2&amp;port=60544&amp;path=livereload" data-no-instant defer></script>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<meta content="keyword 1, keyword 2, keyword 3" name="keywords">
<meta content="CryptoPatrick" name="author">
<meta property="og:title" content="ü¶Äü§ñ: Authenticated MCP Server - Seamless Global Nature">
<meta property="og:url" content="http://localhost:60544/blog/2025/07/10/authenticated-mcp-server/">
<meta property="og:description" content="">
<meta property="og:type" content="website" />


<meta property="og:image" content="http://localhost:60544/img/post-name/name.jpg" />


<title>ü¶Äü§ñ: Authenticated MCP Server | Seamless Global Nature</title>

<link rel="stylesheet" href="http://localhost:60544//css/style.css">
<link rel="stylesheet" href="http://localhost:60544//css/customcode.css">

<link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<link rel="stylesheet"
      href="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.0/build/styles/default.min.css">

</head>

<body>
<section class="section">
  <div class="container">
    <nav class="nav">

 <img src="../../../../../profile.jpg" alt="Avatar" style="margin-right: 1em" height="100px">
      <div class="nav-left" style="flex-basis: auto;">
        <a class="nav-item" href="http://localhost:60544/"><h1 class="title is-4">Seamless Global Nature</h1></a>
      <nav class="nav-item level is-mobile">
          
          
          <a class="level-item" href="http://localhost:60544/about/" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-male"></i>
            </span>
            
            About Me
          </a>
          
          <a class="level-item" href="http://localhost:60544/tags/" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-tags"></i>
            </span>
            
            Tags
          </a>
          
          <a class="level-item" href="https://100-days-of-vibe.vercel.app" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-paper-plane"></i>
            </span>
            
            100DaysOfVibe
          </a>
          
          <a class="level-item" href="https://x.com/cryptopatrick" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-twitter"></i>
            </span>
            
             
          </a>
          
          <a class="level-item" href="https://github.com/cryptopatrick?tab=repositories" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-github"></i>
            </span>
            
             
          </a>
          
          <a class="level-item" href="https://www.instagram.com/cryptopatrickk/" style="display: flex; align-items: center;">
            
            <span class="icon" style="margin-right: 0.175em; display: flex; align-items: center;">
              <i class="fa fa-instagram"></i>
            </span>
            
             
          </a>
          
        </nav>
      </div>
      <div class="nav-right">
        <nav class="nav-item level is-mobile">
          
        </nav>
      </div>
    </nav>
  </div>
</section>

<section class="section">
  <div class="container">
    <h1 class="title">ü¶Äü§ñ: Authenticated MCP Server</h1>
    
    
    <h2 class="subtitle is-5">
      July 10, 2025
       by CryptoPatrick
      
        
        <span class="tags-inline" style="margin-left:0.1em;">
          
            
            <a class="tag is-link is-light" href="../../../../../tags/everydays/" style="margin-left:0.25em;">Everydays</a>
          
            
            <a class="tag is-link is-light" href="../../../../../tags/rust/" style="margin-left:0.25em;">Rust</a>
          
        </span>
      
      
    </h2>
    <div class="content">
      <!-- ////////////////////////////////////////////////////////////////////////-->
<p><img src="https://img.shields.io/badge/Work_In_Progress-orange.svg" alt="Version:0.1.0">
<img src="https://img.shields.io/badge/Text_Version-0.4.5-blue.svg" alt="Version:0.1.0">
<img src="https://img.shields.io/badge/Source_Code_Builds-Yes-green.svg" alt="Version:0.1.0"></p>
<!--![Version:0.1.0](https://img.shields.io/badge/Version-0.5.0-white.svg)  -->
<!--[![Version:0.1.0](https://img.shields.io/badge/File-issue-orange.svg)](https://github.com/cryptopatrick/learn_wgpu/issues)-->
<!-- ////////////////////////////////////////////////////////////////////////-->
<br>
<blockquote>
<p><strong>Preface:</strong> In this Everydays we&rsquo;ll build an MCP server from scratch and connect it to an LLM via a conversational interface like <a href="https://github.com/open-webui/open-webui">OpenWebUI</a>.</p>
</blockquote>
<blockquote>
<p><strong>Code:</strong> The complete source code is available on my <a href="https://github.com/cryptopatrick/mcp_counter">GitHub</a>.</p>
</blockquote>
<!-- ////////////////////////////////////////////////////////////////////////-->
<h2 id="what-is-mcp">What is MCP</h2>
<blockquote>
<p><a href="https://github.com/modelcontextprotocol">Link to official Model Context Protocol SDKs</a></p>
</blockquote>
<p><figure><img src="../../../../../img/time-lock-message/rebellion.jpg">
</figure>
<br>
<strong>‚ñ≤<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup></strong> A Rebel ship orbiting above the Federation&rsquo;s top secret military research lab, <em>The Periphery</em>.</p>
<p>‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä This is a paragraph.
‚†Ä‚†Ä‚†Ä‚†Ä‚†Ä This is another paragraph.</p>
<p><strong>The Future</strong></p>
<p>If we&rsquo;re trying to send a message into the future, then we need to spend some</p>
<h1 id="-implementation">ü¶Ä Implementation</h1>
<p>We&rsquo;ll start by adding the necessary dependencies into our <code>cargo.toml</code> file</p>
<h3 id="file-cargotoml">File: <code>./cargo.toml</code></h3>
<blockquote>
<p><strong>‚è∑ Step 0:</strong>  rmcp is an sdk that will make it easier for us to work with mcp in Rust.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span>[<span style="color:#434f54">dependencies</span>]
</span></span><span style="display:flex;"><span><span style="color:#434f54">rmcp</span> <span style="color:#728e00">=</span> {<span style="color:#434f54">version</span> <span style="color:#728e00">=</span> <span style="color:#7f8c8d">&#34;0.1.5&#34;</span>, <span style="color:#434f54">features</span> <span style="color:#728e00">=</span> [<span style="color:#7f8c8d">&#34;transport-io&#34;</span>]}
</span></span><span style="display:flex;"><span><span style="color:#434f54">tokio</span> <span style="color:#728e00">=</span> {<span style="color:#434f54">version</span> <span style="color:#728e00">=</span> <span style="color:#7f8c8d">&#34;1.43.0&#34;</span>, <span style="color:#434f54">features</span> <span style="color:#728e00">=</span> [<span style="color:#7f8c8d">&#34;full&#34;</span>]}
</span></span><span style="display:flex;"><span><span style="color:#434f54">serde_json</span> <span style="color:#728e00">=</span> <span style="color:#7f8c8d">&#34;1.0.139&#34;</span>
</span></span><span style="display:flex;"><span><span style="color:#434f54">serde</span> <span style="color:#728e00">=</span> {<span style="color:#434f54">version</span> <span style="color:#728e00">=</span> <span style="color:#7f8c8d">&#34;1.0.218&#34;</span>, <span style="color:#434f54">features</span> <span style="color:#728e00">=</span> [<span style="color:#7f8c8d">&#34;derive&#34;</span>]}
</span></span></code></pre></div><h3 id="mainrs">./main.rs</h3>
<blockquote>
<p><strong>‚è∑ Step 01:</strong> We&rsquo;ll start by Exkasdlfjasldfjasldfjl</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#95a5a6">// main.rs
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span><span style="color:#728e00">use</span> <span style="color:#434f54">rmcp</span>::{
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">model</span>::{
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">CallToolResult</span>, <span style="color:#434f54">Content</span>, <span style="color:#434f54">Implementation</span>, <span style="color:#434f54">ProtocolVersion</span>, <span style="color:#434f54">ServerCapabilities</span>,
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">ServerInfo</span>,
</span></span><span style="display:flex;"><span>    }, <span style="color:#434f54">tool</span>, <span style="color:#434f54">transport</span>::<span style="color:#434f54">stdio</span>, <span style="color:#434f54">Error</span>, <span style="color:#434f54">ServerHandler</span>, <span style="color:#434f54">ServiceExt</span>
</span></span><span style="display:flex;"><span>};
</span></span><span style="display:flex;"><span><span style="color:#728e00">use</span> <span style="color:#434f54">std</span>::<span style="color:#434f54">sync</span>::<span style="color:#434f54">Arc</span>;
</span></span><span style="display:flex;"><span><span style="color:#728e00">use</span> <span style="color:#434f54">tokio</span>::<span style="color:#434f54">sync</span>::<span style="color:#434f54">Mutex</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">#[tokio::main]</span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">async</span> <span style="color:#728e00">fn</span> <span style="color:#d35400">main</span>() -&gt; <span style="color:#728e00">Result</span><span style="color:#728e00">&lt;</span>(), <span style="color:#728e00">Box</span><span style="color:#728e00">&lt;</span><span style="color:#728e00">dyn</span> <span style="color:#434f54">std</span>::<span style="color:#434f54">error</span>::<span style="color:#434f54">Error</span><span style="color:#728e00">&gt;&gt;</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">let</span> <span style="color:#434f54">service</span> <span style="color:#728e00">=</span> <span style="color:#434f54">HelloWorld</span>::<span style="color:#434f54">new</span>().<span style="color:#434f54">serve</span>(<span style="color:#434f54">stdio</span>()).<span style="color:#728e00">await</span>.<span style="color:#434f54">inspect_err</span>(<span style="color:#728e00">|</span><span style="color:#434f54">e</span><span style="color:#728e00">|</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">println!</span>(<span style="color:#7f8c8d">&#34;Error found </span><span style="color:#7f8c8d">{e}</span><span style="color:#7f8c8d">&#34;</span>);
</span></span><span style="display:flex;"><span>    })<span style="color:#728e00">?</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">service</span>.<span style="color:#434f54">waiting</span>().<span style="color:#728e00">await</span><span style="color:#728e00">?</span>;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">Ok</span>(())
</span></span><span style="display:flex;"><span> }
</span></span></code></pre></div><blockquote>
<p><strong>‚è∑ Step 02:</strong> Exkasdlfjasldfjasldfjl</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#728e00">#[derive(Clone)]</span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">pub</span> <span style="color:#728e00">struct</span> <span style="color:#434f54">HelloWorld</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">counter</span>: <span style="color:#434f54">Arc</span><span style="color:#728e00">&lt;</span><span style="color:#434f54">Mutex</span><span style="color:#728e00">&lt;</span><span style="color:#00979d">i32</span><span style="color:#728e00">&gt;&gt;</span>,
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span> }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">#[tool(tool_box)]</span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">impl</span> <span style="color:#434f54">HelloWorld</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">// We&#39;ll start by adding a constructor.
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#728e00">pub</span> <span style="color:#728e00">fn</span> <span style="color:#d35400">new</span>() -&gt; <span style="color:#434f54">Self</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">Self</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#434f54">counter</span>: <span style="color:#434f54">Arc</span>::<span style="color:#434f54">new</span>(<span style="color:#434f54">Mutex</span>::<span style="color:#434f54">new</span>(<span style="color:#8a7b52">0</span>))
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#95a5a6">// Next, let&#39;s add some utilities.
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#728e00">#[tool(description = </span><span style="color:#7f8c8d">&#34;Increment counter by one&#34;</span><span style="color:#728e00">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">async</span> <span style="color:#728e00">fn</span> <span style="color:#d35400">increment</span>(<span style="color:#728e00">&amp;</span><span style="color:#434f54">self</span>) -&gt; <span style="color:#728e00">Result</span><span style="color:#728e00">&lt;</span><span style="color:#434f54">CallToolResult</span>, <span style="color:#434f54">Error</span><span style="color:#728e00">&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">let</span> <span style="color:#728e00">mut</span> <span style="color:#434f54">counter</span>  <span style="color:#728e00">=</span> <span style="color:#434f54">self</span>.<span style="color:#434f54">counter</span>.<span style="color:#434f54">lock</span>().<span style="color:#728e00">await</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">*</span><span style="color:#434f54">counter</span> <span style="color:#728e00">+=</span> <span style="color:#8a7b52">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">Ok</span>(<span style="color:#434f54">CallToolResult</span>::<span style="color:#434f54">success</span>(<span style="color:#434f54">vec!</span>[<span style="color:#434f54">Content</span>::<span style="color:#434f54">text</span>(<span style="color:#434f54">counter</span>.<span style="color:#434f54">to_string</span>())]))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">#[tool(description = </span><span style="color:#7f8c8d">&#34;Decrement counter by one&#34;</span><span style="color:#728e00">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">async</span> <span style="color:#728e00">fn</span> <span style="color:#d35400">decrement</span>(<span style="color:#728e00">&amp;</span><span style="color:#434f54">self</span>) -&gt; <span style="color:#728e00">Result</span><span style="color:#728e00">&lt;</span><span style="color:#434f54">CallToolResult</span>, <span style="color:#434f54">Error</span><span style="color:#728e00">&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">let</span> <span style="color:#728e00">mut</span> <span style="color:#434f54">counter</span>  <span style="color:#728e00">=</span> <span style="color:#434f54">self</span>.<span style="color:#434f54">counter</span>.<span style="color:#434f54">lock</span>().<span style="color:#728e00">await</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">*</span><span style="color:#434f54">counter</span> <span style="color:#728e00">-=</span> <span style="color:#8a7b52">1</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">Ok</span>(<span style="color:#434f54">CallToolResult</span>::<span style="color:#434f54">success</span>(<span style="color:#434f54">vec!</span>[<span style="color:#434f54">Content</span>::<span style="color:#434f54">text</span>(<span style="color:#434f54">counter</span>.<span style="color:#434f54">to_string</span>())]))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">#[tool(description = </span><span style="color:#7f8c8d">&#34;Get the current value of the counter.&#34;</span><span style="color:#728e00">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">async</span> <span style="color:#728e00">fn</span> <span style="color:#d35400">get_value</span>(<span style="color:#728e00">&amp;</span><span style="color:#434f54">self</span>) -&gt; <span style="color:#728e00">Result</span><span style="color:#728e00">&lt;</span><span style="color:#434f54">CallToolResult</span>, <span style="color:#434f54">Error</span><span style="color:#728e00">&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">let</span> <span style="color:#434f54">counter</span> <span style="color:#728e00">=</span> <span style="color:#434f54">self</span>.<span style="color:#434f54">counter</span>.<span style="color:#434f54">lock</span>().<span style="color:#728e00">await</span>;
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">Ok</span>(<span style="color:#434f54">CallToolResult</span>::<span style="color:#434f54">success</span>(<span style="color:#434f54">vec!</span>[<span style="color:#434f54">Content</span>::<span style="color:#434f54">text</span>(<span style="color:#434f54">counter</span>.<span style="color:#434f54">to_string</span>())]))
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">#[tool(description = </span><span style="color:#7f8c8d">&#34;Check if comms are open.&#34;</span><span style="color:#728e00">)]</span>
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">async</span> <span style="color:#728e00">fn</span> <span style="color:#d35400">echo</span>(<span style="color:#728e00">&amp;</span><span style="color:#434f54">self</span>) -&gt; <span style="color:#728e00">Result</span><span style="color:#728e00">&lt;</span><span style="color:#434f54">CallToolResult</span>, <span style="color:#434f54">Error</span><span style="color:#728e00">&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#728e00">Ok</span>(<span style="color:#434f54">CallToolResult</span>::<span style="color:#434f54">success</span>(<span style="color:#434f54">vec!</span>[<span style="color:#434f54">Content</span>::<span style="color:#434f54">text</span>(<span style="color:#728e00">String</span>::<span style="color:#434f54">from</span>(<span style="color:#7f8c8d">&#34;Server: confirming that coms are up.&#34;</span>))]))
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><blockquote>
<p><strong>‚è∑ Step 03:</strong> We&rsquo;ll start by Exkasdlfjasldfjasldfjl</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#95a5a6">// Next we create a server handler for our struct.
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span><span style="color:#728e00">#[tool(tool_box)]</span>
</span></span><span style="display:flex;"><span><span style="color:#728e00">impl</span> <span style="color:#434f54">ServerHandler</span> <span style="color:#728e00">for</span> <span style="color:#434f54">HelloWorld</span> {
</span></span><span style="display:flex;"><span>    <span style="color:#728e00">fn</span> <span style="color:#d35400">get_info</span>(<span style="color:#728e00">&amp;</span><span style="color:#434f54">self</span>) -&gt; <span style="color:#434f54">ServerInfo</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#434f54">ServerInfo</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#434f54">protocol_version</span>: <span style="color:#434f54">ProtocolVersion</span>::<span style="color:#434f54">V_2024_11_05</span>,
</span></span><span style="display:flex;"><span>            <span style="color:#434f54">capabilities</span>: <span style="color:#434f54">ServerCapabilities</span>::<span style="color:#434f54">builder</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#434f54">enable_tools</span>()
</span></span><span style="display:flex;"><span>                .<span style="color:#434f54">build</span>(),
</span></span><span style="display:flex;"><span>                <span style="color:#434f54">server_info</span>: <span style="color:#434f54">Implementation</span>::<span style="color:#434f54">from_build_env</span>(),
</span></span><span style="display:flex;"><span>                <span style="color:#434f54">instructions</span>: <span style="color:#728e00">Some</span>(<span style="color:#728e00">String</span>::<span style="color:#434f54">from</span>(<span style="color:#7f8c8d">&#34;Server provides a counter tool functionality.&#34;</span>)),
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><h3 id="chat-client-claude">Chat client: Claude</h3>
<p>We&rsquo;re going to use Claude or LM Studio as chatclient, but you can user whatever you like.</p>
<h3 id="connect-our-mcp-server-to-lmstudio">Connect our MCP server to LMStudio</h3>
<p>To connect our chat client to the development server, we need to configure its MCP config file.
We&rsquo;ll use the amazing <a href="http://www.lmstudio.ai">LM Stuio</a> to connect to our MCP server.<br>
Having consulted the <a href="https://lmstudio.ai/docs/app/plugins/mcp">LM docs on the matter </a> we
learn that we need to:</p>
<blockquote>
<p>Please note: we need LM Studio version <strong>0.3.17</strong> for this to work, LM Studio acts as an Model Context Protocol (MCP) Host. This means you can connect MCP servers to the app and make them available to your models.</p>
</blockquote>
<blockquote>
<p>path to claude or lm studio .config file.json</p>
</blockquote>
<pre tabindex="0"><code>{
    &#34;mcpServers&#34;: {
        &#34;mcp_counter&#34;: {
            &#34;command&#34;:  &#34;/Users/cp/wer/everydays/round01/mcp_counter/target/release/mcp_counter&#34;,
            &#34;args&#34;: []
        }
    }
}
</code></pre><p>According to the MCP specification, an mcp server should expose the following endpoints:</p>
<ul>
<li>/.well-known/ai-plugin.json ‚Äì plugin metadata</li>
<li>/mcp/manifest.json ‚Äì MCP-specific manifest</li>
<li>/mcp/openapi.json ‚Äì OpenAPI schema for your endpoints</li>
<li>Your custom API endpoint(s) (e.g., /get_weather, /query_db, etc.)
These follow the OpenAI Plugin-style TODO: add refefence.</li>
</ul>
<pre tabindex="0"><code>

&gt; You can install MCP servers in LM Studio with one click using a deeplink.
https://lmstudio.ai/docs/app/plugins/mcp/deeplink


# claude_d
Benchmarking FastAPI vs. Axum
Luke Hsiao published 2023-09-10 updated 2024-01-27 3 min read

I wanted to run a simple benchmark of two common stacks as a way to get a sense of baselines between Python and Rust for a backend web server. For Python, a common choice is FastAPI and SQLAlchemy. For Rust, a common choice is Axum and SQLx. How do they compare?

At least two similar comparisons have been made.

    Zach Coleman‚Äôs FastAPI vs Axum
    Vagelis Prokopiou‚Äôs FastAPI vs Axum

I wanted to do things slightly differently.

Coleman‚Äôs approach uses only a single CPU with limits the benefits of concurrency. It also doesn‚Äôt interact with a database.

Prokopiou‚Äôs approach is much more ‚Äúreal‚Äù. In fact, a little too ‚Äúreal‚Äù as to make the codebase a bit harder to quickly grok.

I wanted something between these two: (1) still include a database in the hot path and (2) make the codebase as simple as possible.
The benchmark

Each web server implements a single endpoint that runs

SELECT * FROM &#34;users&#34; ORDER BY user_id LIMIT 100

from a local, Dockerized Postgres database seeded with 2000 users and returns the result as JSON. I chose this query somewhat arbitrarily. It‚Äôs not particularly interesting if the database query time dominates the time so much that the comparison is not useful (e.g., say we seeded 10k users and returned the entire list every time). But, it‚Äôs also not particularly interesting if there is no database interacting, since that‚Äôs what your basic CRUD backends always do some of.

Both use a connection pool of up to 5 connections, and both are based extremely closely on tutorial/example code from FastAPI and Axum.

Along the way, I got to try a handful of new HTTP benchmarking tools from this awesome list, and came across oha (also used by Prokopiou), and really enjoyed it.

That, along with btm, makes for very fun-to-watch interactive benchmarking.
Terminal Screenshot
Interactive benchmarking in the terminal can be beautiful.
Results

‚ö†Ô∏è NOTE: The benchmarks have been updated with an asynchronous version of FastAPI and run on newer hardware. Please see the repository for updated results! ‚ö†Ô∏è

On my personal PC with 16 GB of RAM and a Ryzen 7 3700X (8-core, 16-thread), I saw the following.
Metric	FastAPI	Axum	Change (%)
Throughput (rps)	305	9740	+3090
50% latency (ms)	30	1.0	-97
99% latency (ms)	74	1.4	-98
Peak Memory Usage (MiB)	83	10	-88

Dramatic improvements using Rust all around.

In particular, I was shocked at how large the latencies were for FastAPI, especially because this was running locally with no network latency.
Try it yourself

Please, go play with the code yourself!

In particular, please tell me if you think I‚Äôm doing something wrong or too unfair‚Äîbenchmarks are hard! For example, I‚Äôm sure I have a coordinated omission problem on my hands, but I‚Äôm not quite sure what the most fair way to address it is.

https://github.com/lukehsiao/axum-fastapi
sktop_config.json
{
    &#34;mcpServers&#34;: {
        &#34;mcp_counter&#34;: {
            &#34;command&#34;:  &#34;/Users/cp/wer/everydays/round01/mcp_counter/target/release/mcp_counter&#34;,
            &#34;args&#34;: []
        }
    }
}


{
  &#34;mcpServers&#34;: {
    &#34;mcp.shop&#34;: {
      &#34;command&#34;: &#34;npx&#34;,
      &#34;args&#34;: [&#34;-y&#34;, &#34;mcp-remote&#34;, &#34;http://localhost:3000/mcp&#34;]
    }
  }
}
</code></pre><h2 id="wave-adding-authentication-to-our-mcp-server-using-authkit">&#x1f44b; Adding Authentication to our MCP Server using AuthKit</h2>
<p>For authenticaiotn to work we need to configure our WorkOS:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span><span style="color:#434f54">AUTHKIT_DOMAIN</span><span style="color:#728e00">=</span>your-authkit-domain
</span></span><span style="display:flex;"><span><span style="color:#434f54">WORKOS_API_KEY</span><span style="color:#728e00">=</span>your-workos-api-key
</span></span><span style="display:flex;"><span><span style="color:#434f54">WORKOS_CLIENT_ID</span><span style="color:#728e00">=</span>your-workos-client-id
</span></span></code></pre></div><p>You can view your AuthKit metadata by making a request to its /.well-known/oauth-authorization-server endpoint:
curl https://<subdomain>.authkit.app/.well-known/oauth-authorization-server | jq</p>
<p>The MCP specification builds on industry-standard protocols like
OAuth 2.0 in order to secure access to our MCP server.</p>
<p>There are two entities at play here - 1. our mcp server, and 2. AuthKit handling authentication for us.</p>
<p>AuthKit does the heavy lifting for us, but our MCP server needs to:</p>
<ol>
<li>verify access token issued by AuthKit for our MCP server</li>
<li>direct clients ot AuthKit using standardized metadata endpoint.</li>
</ol>
<h4 id="enabling-dynamic-client-registration">Enabling Dynamic Client Registration</h4>
<p>The MCP protocol requires authorization servers (AuthKit) to implement the
OAuth 2.0 Dynamic Client Registration.
We do this here: WorkOS Dashboard under Applications ‚Üí Configuration.</p>
<hr>
<p>Allow third-party applications to be created using a public API. This will enable the OAuth 2.0 Dynamic Client Registration</p>
<p>endpoint, allowing clients to register themselves without prior action by a developer or admin.</p>
<p>While developers of more traditional applications using WorkOS Connect will not need this feature, it is required by the authorization flow for Model Context Protocol (MCP) servers</p>
<hr>
<p>// Our MCP server needs to implement /.well-known/oauth-protected-resource endpoint
// returning the following minimal JSON response:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-rust" data-lang="rust"><span style="display:flex;"><span><span style="color:#434f54">app</span>.<span style="color:#434f54">get</span>(<span style="color:#434f54">&#39;</span><span style="color:#728e00">/</span>.<span style="color:#434f54">well</span><span style="color:#728e00">-</span><span style="color:#434f54">known</span><span style="color:#728e00">/</span><span style="color:#434f54">oauth</span><span style="color:#728e00">-</span><span style="color:#434f54">protected</span><span style="color:#728e00">-</span><span style="color:#434f54">resource</span><span style="color:#434f54">&#39;</span>, (<span style="color:#434f54">req</span>, <span style="color:#434f54">res</span>) <span style="color:#728e00">=&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#434f54">res</span>.<span style="color:#434f54">json</span>({
</span></span><span style="display:flex;"><span>    <span style="color:#434f54">resource</span>: <span style="color:#a61717">`</span><span style="color:#434f54">https</span>:<span style="color:#95a5a6">//mcp.example.com`,
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#434f54">authorization_servers</span>: [<span style="color:#434f54">&#39;https</span>:<span style="color:#95a5a6">//&lt;subdomain&gt;.authkit.app&#39;],
</span></span></span><span style="display:flex;"><span><span style="color:#95a5a6"></span>    <span style="color:#434f54">bearer_methods_supported</span>: [<span style="color:#434f54">&#39;header&#39;</span>],
</span></span><span style="display:flex;"><span>  }),
</span></span><span style="display:flex;"><span>);
</span></span></code></pre></div><p>Once we&rsquo;ve have successful authentication, the client will receive credentials
and can start making requests to our application‚Äôs MCP endpoints.</p>
<h4 id="compatibility">compatibility</h4>
<p>For users, who&rsquo;s client does not  support the <em>OAuth 2.0 Protected Resource Metadata</em>
spec and its <em>/.well-known/oauth-protected-resource</em> endpoint, there is the possibliity to
implement a metadata endpoint as a proxy with AuthKit as the upstream source of truth:</p>
<pre tabindex="0"><code>app.get(&#39;/.well-known/oauth-authorization-server&#39;, async (req, res) =&gt; {
  const response = await fetch(
    &#39;https://&lt;subdomain&gt;.authkit.app/.well-known/oauth-authorization-server&#39;,
  );
  const metadata = await response.json();

  res.json(metadata);
});
</code></pre><p>Acceess to our mcp servers endpoints are protected by requiring access tokens issued by AuthKit for our MCP server.</p>
<blockquote>
<p>At the time of writing, AuthKit offers a free plan (without the need to enter your credit card data) and up to 1_000_000 Monthly Active Users (MOA). After that it&rsquo;s $2_500 per million users/month.</p>
</blockquote>
<p>This project demonstrates how to use AuthKit with MCP to create a secure web shop where users can:</p>
<pre><code>Connect to an MCP server
Authenticate via AuthKit
Order t-shirts using MCP tools
View order details (admin users only)
</code></pre>
<p>Key components:</p>
<pre><code>Authentication logic: lib/with-authkit.ts
Client registration: app/.well-known/
MCP implementation: app/[transport]/route.ts
</code></pre>
<h2 id="awesome-mcp-servers">Awesome MCP Servers</h2>
<p>There are lots of MCP servers out there that we can experiment.
<a href="https://github.com/punkpeye/awesome-mcp-servers">Just go to and have a look.</a></p>
<hr>
<p>We need to integrate our jwt middleware into our Axum web framework,
adapting the <em>RequestContext</em> and <em>Response</em> types to match the framework&rsquo;s types.</p>
<p>Replace <subdomain> in the JWKS URL and issuer with the actual subdomain.
Handle the token claims (e.g., token_data.claims) as needed for your application.
The code assumes RSA256 for JWT signing; adjust the algorithm in Validation::new if your JWKS uses a different algorithm.</p>
<hr>
<!-- ////////////////////////////////////////////////////////////////////////-->
<h3 id="title">Title</h3>
<p><strong>List of topics to cover (briefly):</strong> <br>
[ ] Carmicheal Numbers and the need for primality testing of huge numbers<br>
[x] Probabilitic Primality Testing with Rabin-Miller</p>
<table>
  <thead>
      <tr>
          <th style="text-align: center">Step</th>
          <th style="text-align: left">Process</th>
      </tr>
  </thead>
  <tbody>
      <tr>
          <td style="text-align: center"><a href="#step-0-preparing-the-payload">0.</a></td>
          <td style="text-align: left">Gather message data, calculate time-lock duration, estimate attacker&rsquo;s squaring power</td>
      </tr>
      <tr>
          <td style="text-align: center"><a href="#step-1-compute-the-composite-modulus">1.</a></td>
          <td style="text-align: left">Choose two secret primes, $p$ and $q$, and compute the composite modulus: $n=p \cdot q$</td>
      </tr>
  </tbody>
</table>
<p><strong>‚ñ≤</strong> The seven steps of creating a Time-Lock Puzzle.</p>
<!-- ////////////////////////////////////////////////////////////////////////-->
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p>Ai-generated image of Rebel spaceship.&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div>




    </div>
    
    
  </div>
</section>

<section class="section">
  <div class="container has-text-centered">
    <p>'I write to understand as much as to be understood.' ‚ÄîElie Wiesel<br> (c) 2024 CryptoPatrick</p>
  </div>
</section>

<script src="//cdn.jsdelivr.net/gh/highlightjs/cdn-release@10.2.0/build/highlight.min.js"></script>
<script>hljs.initHighlightingOnLoad();</script>




</body>
